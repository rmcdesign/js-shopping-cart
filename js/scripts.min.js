!function(t,e){"use strict";var a=e("#cart-list-template").html(),r=Handlebars.compile(a),o=e("#product-list-template").html(),i=Handlebars.compile(o),c={products:[{id:0,name:"Almond Toe Court Shoes, Patent Black",category:"Women’s Footwear",price:"99.00",reducedBy:0,quantity:5},{id:1,name:"Suede Shoes, Blue",category:"Women’s Footwear",price:"42.00",reducedBy:0,quantity:4},{id:2,name:"Leather Driver Saddle Loafers, Tan",category:"Men’s Footwear",price:"34.00",reducedBy:0,quantity:12},{id:3,name:"Flip Flops, Red",category:"Men’s Footwear",price:"19.00",reducedBy:0,quantity:6},{id:4,name:"Flip Flops, Blue",category:"Men’s Footwear",price:"19.00",reducedBy:0,quantity:0},{id:5,name:"Gold Button Cardigan, Black",category:"Women’s Casualwear",price:"167.00",reducedBy:0,quantity:6},{id:6,name:"Cotton Shorts, Medium Red",category:"Women’s Casualwear",price:"30.00",reducedBy:0,quantity:5},{id:7,name:"Fine Stripe Short Sleeve Shirt, Grey",category:"Men’s Casualwear",price:"49.99",reducedBy:0,quantity:9},{id:8,name:"Fine Stripe Short Sleeve Shirt, Green",category:"Men’s Casualwear",price:"39.99",reducedBy:10,quantity:3},{id:9,name:"Sharkskin Waistcoat, Charcoal",category:"Men’s Formalwear",price:"75.00",reducedBy:0,quantity:2},{id:10,name:"Lightweight Patch Pocket Blazer, Deer",category:"Men’s Formalwear",price:"175.50",reducedBy:0,quantity:1},{id:11,name:"Bird Print Dress, Black",category:"Women’s Formalwear",price:"270.00",reducedBy:0,quantity:10},{id:12,name:"Mid Twist Cut-Out Dress, Pink",category:"Women’s Formalwear",price:"540.00",reducedBy:0,quantity:5}]},n=e.extend(!0,{},c);e("#product-list").html(i(c));var d={};d.init=function(){d.setVariables(),d.bindEvents()},d.setVariables=function(){d.$doc=e(document),d.$productList=e("#product-list"),d.$shoppingBasket=e("#shopping-basket"),d.footwearItems=0,d.cart={total:0}},d.bindEvents=function(){d.$doc.on("click",".add-to-cart",d.addItemToCart),d.$doc.on("click",".delete",d.removeItemFromCartList),d.$doc.on("click",".toggle-cart",d.toggleCart),d.$doc.on("click",".apply-voucher",d.validateVoucher),d.$doc.on("keyup","#voucher",function(){13==event.keyCode&&d.validateVoucher()})},d.toggleCart=function(){d.$productList.slideToggle("fast"),d.$shoppingBasket.slideToggle("fast")},d.removeItemFromCartList=function(){var t=e(this).data("id"),a=e(this).parent(".cart-item");a.slideUp(400,function(){a.remove(),d.deleteItemFromCart(t)})},d.addItemToCart=function(){var t=e(this).data("id"),a=c.products[t],r=!1;if("undefined"==typeof d.cart.items)d.cart.items=[];else for(var o=0;o<d.cart.items.length;o++)"undefined"!=typeof d.cart.items[o]&&d.cart.items[o].id===t&&(r=!0,c.products[t].quantity>0?(d.cart.items[o].count++,c.products[t].quantity--,d.updateTotal()):console.log("no stock left"));r||(a.count=1,d.cart.items.push(a),c.products[t].quantity--,d.updateTotal()),a.category.indexOf("Footwear")&&d.footwearItems++},d.deleteItemFromCart=function(t){c.products[t].quantity=n.products[t].quantity;for(var e=0;e<d.cart.items.length;e++)d.cart.items[e].id===t&&d.cart.items.splice(e,1);d.updateTotal()},d.updateTotal=function(){d.updateCartList(),d.updateList();var t=0,a=0,r=e(".basket-count");e(".cart-item").each(function(){var r=e(this),o=parseFloat(r.find(".cart-quantity").text()),i=parseFloat(r.find(".cart-price").text()).toFixed(2);t+=o,a+=i*o}),d.cart.total=a.toFixed(2),1===t?r.html(t+" item"):t>1?r.html(t+" items"):r.html("Basket empty"),e(".cart-total").html("£"+d.cart.total)},d.updateCartList=function(){e("#shopping-cart-list").html(r(d.cart))},d.updateList=function(){e("#product-list").html(i(c))},d.applyDiscount=function(t){var a=d.cart.total-t;d.cart.total=a.toFixed(2),e(".show-discount").html("Discount applied: -£"+t.toFixed(2)),e(".cart-total").html("£"+d.cart.total)},d.voucherStatus=function(t){var a=e(".discount-status");t?a.addClass("voucher-valid").fadeIn().html("Your voucher as been successfully applied"):a.fadeIn().html("Sorry the voucher you entered was invalid"),setTimeout(function(){a.slideUp()},3e3)},d.validateVoucher=function(){var t=e("#voucher"),a=t.val();switch(t.val(""),e(".show-discount").html(""),a.toUpperCase()){case"FIVEOFF":d.applyDiscount(5),d.voucherStatus(!0);break;case"BIGSPENDER":d.applyDiscount(10),d.voucherStatus(!0);break;case"FOOTWEAR":d.footwearItems>0&&(d.applyDiscount(15),d.voucherStatus(!0));break;default:d.voucherStatus(!1)}},d.init()}(window,jQuery);