!function(t,e){function a(t){var e=v.products[t],a=!1;if("undefined"==typeof g.items)g.items=[];else for(i=0;i<g.items.length;i++)"undefined"!=typeof g.items[i]&&g.items[i].id===t&&(a=!0,v.products[t].quantity>0?(g.items[i].count++,v.products[t].quantity--,r()):console.log("no stock left"));a||(e.count=1,g.items.push(e),v.products[t].quantity--,r()),e.category.indexOf("Footwear")&&f++}function o(t){for(var e=0;e<g.items.length;e++)g.items[e].id===t&&(g.items[e].count>0?(g.items[e].count--,v.products[e].quantity++,r()):console.log("nothing to delete"))}function n(t){v.products[t].quantity=F.products[t].quantity;for(var e=0;e<g.items.length;e++)g.items[e].id===t&&g.items.splice(e,1);r()}function r(){c(),d();var t=0,a=0,i=e(".basket-count");e(".checkout");e(".cart-item").each(function(){var i=e(this),o=parseFloat(i.find(".cart-quantity").text()),n=parseFloat(i.find(".cart-price").text()).toFixed(2);t+=o,a+=n*o}),g.total=a.toFixed(2),1===t?i.html(t+" item"):t>1?i.html(t+" items"):i.html("Basket empty"),e(".cart-total").html("£"+g.total)}function c(){e("#shopping-cart-list").html(p(g))}function d(){e("#product-list").html(h(v))}function s(t){var a=g.total-t;g.total=a.toFixed(2),e(".show-discount").html("Discount applied: -£"+t.toFixed(2)),e(".cart-total").html("£"+g.total)}function u(t){t?e(".discount-status").addClass("voucher-valid").fadeIn().html("Your voucher as been successfully applied"):e(".discount-status").fadeIn().html("Sorry the voucher you entered was invalid"),setTimeout(function(){e(".discount-status").slideUp()},3e3)}function l(){var t=e("#voucher"),a=t.val();switch(t.val(""),e(".show-discount").html(""),a.toUpperCase()){case"FIVEOFF":s(5),u(!0);break;case"BIGSPENDER":s(10),u(!0);break;case"FOOTWEAR":f>0&&(s(15),u(!0));break;default:u(!1)}}var m=e("#cart-list-template").html(),p=Handlebars.compile(m),y=e("#product-list-template").html(),h=Handlebars.compile(y),f=0,g={total:0},v={products:[{id:0,name:"Almond Toe Court Shoes, Patent Black",category:"Women’s Footwear",price:"99.00",reducedBy:0,quantity:5},{id:1,name:"Suede Shoes, Blue",category:"Women’s Footwear",price:"42.00",reducedBy:0,quantity:4},{id:2,name:"Leather Driver Saddle Loafers, Tan",category:"Men’s Footwear",price:"34.00",reducedBy:0,quantity:12},{id:3,name:"Flip Flops, Red",category:"Men’s Footwear",price:"19.00",reducedBy:0,quantity:6},{id:4,name:"Flip Flops, Blue",category:"Men’s Footwear",price:"19.00",reducedBy:0,quantity:0},{id:5,name:"Gold Button Cardigan, Black",category:"Women’s Casualwear",price:"167.00",reducedBy:0,quantity:6},{id:6,name:"Cotton Shorts, Medium Red",category:"Women’s Casualwear",price:"30.00",reducedBy:0,quantity:5},{id:7,name:"Fine Stripe Short Sleeve Shirt, Grey",category:"Men’s Casualwear",price:"49.99",reducedBy:0,quantity:9},{id:8,name:"Fine Stripe Short Sleeve Shirt, Green",category:"Men’s Casualwear",price:"39.99",reducedBy:10,quantity:3},{id:9,name:"Sharkskin Waistcoat, Charcoal",category:"Men’s Formalwear",price:"75.00",reducedBy:0,quantity:2},{id:10,name:"Lightweight Patch Pocket Blazer, Deer",category:"Men’s Formalwear",price:"175.50",reducedBy:0,quantity:1},{id:11,name:"Bird Print Dress, Black",category:"Women’s Formalwear",price:"270.00",reducedBy:0,quantity:10},{id:12,name:"Mid Twist Cut-Out Dress, Pink",category:"Women’s Formalwear",price:"540.00",reducedBy:0,quantity:5}]},F=e.extend(!0,{},v);e("#product-list").html(h(v)),e(document).on("click",".add-to-cart",function(){var t=e(this).data("id");a(t)}),e(document).on("click",".minus-item",function(){var t=e(this).data("id");o(t)}),e(document).on("click",".delete",function(){var t=e(this).data("id"),a=e(this).parent(".cart-item");a.slideUp(400,function(){a.remove(),n(t)})}),e(".toggle-cart").on("click",function(){var t=e("#product-list"),a=e("#shopping-basket");t.slideToggle("fast"),a.slideToggle("fast")}),e(document).on("keyup","#voucher",function(){13==event.keyCode&&l()}),e(document).on("click",".apply-voucher",l)}(window,jQuery);